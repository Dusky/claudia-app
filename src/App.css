* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html, body, #root {
  height: 100vh;
  overflow: hidden;
  background: linear-gradient(160deg, #08080A 0%, #030305 100%);
  
  /* Attempt to disable default browser font smoothing for a more retro pixelated look */
  /* These are suggestions and browser support/effect varies */
  font-smooth: never;
  -webkit-font-smoothing: none;
  -moz-osx-font-smoothing: grayscale;
  /* For true pixel fonts, this helps maintain crispness if not blurred by shader */
  /* image-rendering: pixelated; /* or crisp-edges - apply this on specific elements if needed */
}

/* 
 * CRITICAL LAYOUT STRUCTURE - DO NOT MODIFY WITHOUT UNDERSTANDING
 * 
 * App Layout Architecture:
 * .App (flexbox column) - Full viewport height
 *   ├── TopBar (flex-shrink: 0) - Fixed height 48px
 *   ├── .main-content (flex: 1) - Takes remaining space
 *   │   └── .terminal-container (flex: 1) - Full main-content space
 *   │       └── TerminalDisplay - Handles internal scrolling
 *   └── StatusBar (flex-shrink: 0) - Fixed height 28px
 * 
 * This prevents:
 * - Input being covered by fixed positioned elements
 * - Content overflow outside viewport
 * - Layout conflicts when adding new UI elements
 * 
 * NEVER use position: fixed for TopBar or StatusBar!
 * ALWAYS use flex-shrink: 0 for fixed-size elements!
 */
.App {
  height: 100vh;
  width: 100vw;
  overflow: hidden;
  position: relative;
  /* Neutral background - themes control their own backgrounds */
  background: #0a0a0a;
  display: flex;
  flex-direction: column;
}

/* Simplified background effects for app shell */
.App::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--crt-gradient-background, none);
  animation: backgroundPulse 8s ease-in-out infinite;
  pointer-events: none;
  z-index: 1; /* Above .App's direct background, below its content */
}

.App::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='1.2' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
  pointer-events: none;
  z-index: 0; /* Below .App's direct background */
  opacity: 0.8;
}

@keyframes backgroundPulse {
  0%, 100% { 
    opacity: 0.6;
    transform: scale(1);
  }
  50% { 
    opacity: 0.8;
    transform: scale(1.05);
  }
}

/* 
 * MAIN CONTENT AREA - Takes remaining space between TopBar and StatusBar
 * This ensures the terminal input is never covered by fixed elements
 */
.main-content {
  flex: 1; /* Take remaining space between TopBar and StatusBar */
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden; /* Prevent content from overflowing main area */
  min-height: 0; /* Allow flex child to shrink below content size */
  z-index: 2; /* Ensure main content is above .App::before/::after */
}

/* 
 * TERMINAL CONTAINER - Full space within main-content with proper scrolling
 * This handles the terminal display and ensures input stays visible
 */
.terminal-container {
  flex: 1; /* Take all available space in main-content */
  width: 100%;
  overflow-y: auto; /* For internal scrolling of TerminalDisplay */
  position: relative;
  /* z-index: 2; Removed, main-content handles z-index relative to .App pseudos */
  backdrop-filter: blur(0.5px); /* This will blur the .App background if terminal-container's own bg is transparent */
  display: flex;
  flex-direction: column;
  min-height: 0; /* Allow flex child to shrink below content size */
  /* Background for .terminal-container is now handled by app-background-layer in TerminalDisplay.tsx via theme.effects.appBackground */
}


/* REMOVED: CSS-generated circuit board wallpaper for terminal-container */
/* This should be part of theme.effects.appBackground if desired for a specific theme */
/* .terminal-container::before { ... } */

@keyframes circuitFlow {
  0% { 
    background-position:
      0 0, 20px 0,
      0 0, 0 20px,
      0 0, 0 0, 0 0, 0 0,
      0 0, 0 0,
      0 0, 0 0;
  }
  100% { 
    background-position:
      120px 0, 140px 0,
      0 120px, 0 140px,
      120px 120px, 120px 120px, 120px 120px, 120px 120px,
      120px 120px, 120px 120px,
      20px 20px, 20px 20px;
  }
}

/* REMOVED: Enhanced theme-specific backgrounds for .terminal-container */
/* These are now handled by theme.effects.appBackground in themes.ts, applied to app-background-layer in TerminalDisplay.tsx */
/*
.terminal-container[data-theme="mainframe70s"] { ... }
.terminal-container[data-theme="pc80s"] { ... }
.terminal-container[data-theme="bbs90s"] { ... }
.terminal-container[data-theme="modern"] { ... }
*/

/* Avatar positioning and z-index only - styling moved to theme system */
.claudia-avatar {
  z-index: 1000; /* Ensure avatar is above terminal content but below modals */
  transition: all 0.3s ease;
}

.claudia-avatar:hover {
  transform: scale(1.02);
}

/* Hide default scrollbars in Firefox */
.terminal-container {
  scrollbar-width: thin;
}

/* REMOVED: Enhanced scrollbar styling - now handled by TerminalDisplay.tsx theme system */

/* Global selection styling - uses CSS custom properties for theme flexibility */
:root {
  --selection-background: rgba(0, 255, 255, 0.3);
  --selection-text-shadow: 0 0 8px currentColor;
}

::selection {
  background: var(--selection-background);
  color: inherit;
  text-shadow: var(--selection-text-shadow);
}

::-moz-selection {
  background: var(--selection-background);
  color: inherit;
  text-shadow: var(--selection-text-shadow);
}

/* REMOVED: Terminal text enhancements - now handled by TerminalDisplay.tsx theme system */

/* REMOVED: Loading animation enhancement - now handled by TerminalDisplay.tsx theme system */

/* REMOVED: Input field enhancements - now handled by TerminalDisplay.tsx theme system */

/* Responsive design - layout only */
@media (max-width: 768px) { 
  /* Layout adjustments if needed */
}

@media (max-width: 480px) { 
  .App::before {
    animation: backgroundPulse 12s ease-in-out infinite; 
  }
}

@media (max-width: 360px) { 
  .App::after { 
    opacity: 0.4;
  }
}


/* REMOVED: Special effects for different terminal themes - now handled by overlays.css and theme system */

/* REMOVED: Enhanced Loading Animations - now handled by TerminalDisplay.tsx theme system */

/* REMOVED: Theme-specific loading dots - now handled by TerminalDisplay.tsx theme system */

/* Global transitions for theme switching */
.App {
  transition: background-color 0.6s ease-in-out, background 0.6s ease-in-out;
}

/* Theme Switch Animation */
.theme-transition {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: radial-gradient(circle, transparent 0%, rgba(0,0,0,0.8) 100%);
  z-index: 1500;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease-in-out;
}

.theme-transition.active {
  opacity: 1;
  animation: themeRipple 0.6s ease-out;
}

@keyframes themeRipple {
  0% {
    background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.1) 0%, transparent 0%);
  }
  50% {
    background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.05) 30%, transparent 70%);
  }
  100% {
    background: radial-gradient(circle at 50% 50%, transparent 0%, transparent 100%);
  }
}

/* Modal Entrance/Exit Animations */
.modal-overlay {
  transition: opacity 0.3s ease-in-out;
}

.modal-content {
  transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.3s ease-in-out;
  transform: scale(0.9) translateY(-20px);
  opacity: 0;
}

.modal-content.open {
  transform: scale(1) translateY(0);
  opacity: 1;
}

.modal-content.closing {
  transform: scale(0.95) translateY(10px);
  opacity: 0;
}

/* Command Execution Feedback */
@keyframes commandSuccess {
  0% {
    transform: translateX(-5px);
    border-left-width: 0px;
    background: transparent;
  }
  30% {
    transform: translateX(0);
    border-left-width: 3px;
  }
  100% {
    transform: translateX(0);
    border-left-width: 2px;
  }
}

.command-success {
  position: relative;
}

.command-success::before {
  content: '✓';
  position: absolute;
  left: -16px;
  top: 0;
  color: inherit;
  font-size: 0.8em;
  opacity: 0.7;
  animation: successIcon 0.6s ease-out;
}

@keyframes successIcon {
  0% {
    opacity: 0;
    transform: scale(0.5);
  }
  50% {
    opacity: 1;
    transform: scale(1.2);
  }
  100% {
    opacity: 0.7;
    transform: scale(1);
  }
}

/* Input Command Animation */
.terminal-line[data-type="input"] {
  animation: inputSlide 0.2s ease-out;
}

@keyframes inputSlide {
  0% {
    opacity: 0;
    transform: translateX(-10px);
  }
  100% {
    opacity: 1;
    transform: translateX(0);
  }
}
